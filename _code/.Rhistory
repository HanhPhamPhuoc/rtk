"\n\n### On-Yomi: ",l.on,
ifelse(l.kun=="",""," &mdash; Kun-Yomi: "),l.kun,
# ifelse(l.example == "","",
#			 "\n\n### Examples: "), l.example,
# ifelse(l.word == "","","\n\n## Words:\n\n"), l.word,
"\n\n## Heisig V6:",
"\n\n", l.hei,
"\n\n## Premitive V4:",
"\n\n", koo.v4[no=l.no,2],
"\n\n## Koohii stories:",
"\n\n", koo.v4[no=l.no,3])
l.path <- paste0("/data/repos/manhtai/rtk/jisho/",l.na,".md")
writeLines(content, l.path)
line <- data[i]
line <- str_split(line, "\037")
l <- line[[1]]
l.no <- l[2]
l.key <- l[4]
l.ka <- l[5]
l.image <- l[6]
l.image <- str_replace(l.image, "src=\"", "src=\"../images/")
l.image <- paste0("<div class=\"stroke\">",l.image,"</div>")
l.strokes <- l[9]
l.hei <- l[11]
l.hei <- str_replace_all(l.hei, "\"", "&quot;")
l.hei <- str_replace_all(l.hei, "<div>", "<p>")
l.hei <- str_replace_all(l.hei, "</div>", "</p>")
l.on <- l[17]
l.kun <- l[18]
l.word <- l[19]
l.word <- str_replace_all(l.word, "<br[ ]*[/]?>", "\n\n")
l.example <- l[20]
l.na <- paste0(str_dup("0",4-str_length(l.no)),l.no)
content <- paste0("---\nlayout: post\ntitle: " ,l.ka," ",l.key,
"\nkanji: ", l.ka,
"\npermalink: /", l.no,"/",
"\nredirect_from:",
"\n - /", l.ka, "/",
"\n - /", tolower(l.key), "/",
"\npre_kanji: ", l.nav[i],
"\nnex_kanji: ", l.nav[i+2],
"\nheisig: \"",l.hei,"<br>",koo.v4[no=l.no,2],"\"",
"\n---",
"\n\n## `", l.key,"`",
"\n\n## [",l.strokes,"]\n\n",l.image,
"\n\n## Reading:",
"\n\n### On-Yomi: ",l.on,
ifelse(l.kun=="",""," &mdash; Kun-Yomi: "),l.kun,
# ifelse(l.example == "","",
#			 "\n\n### Examples: "), l.example,
# ifelse(l.word == "","","\n\n## Words:\n\n"), l.word,
"\n\n## Heisig V6:",
"\n\n", l.hei,
ifelse(koo.v4[no=l.no,2]=="","",
"\n\n## Premitive V4:\n\n"), koo.v4[no=l.no,2],
"\n\n## Koohii stories:",
"\n\n", koo.v4[no=l.no,3])
l.path <- paste0("/data/repos/manhtai/rtk/jisho/",l.na,".md")
writeLines(content, l.path)
line <- data[i]
line <- str_split(line, "\037")
l <- line[[1]]
l.no <- l[2]
l.key <- l[4]
l.ka <- l[5]
l.image <- l[6]
l.image <- str_replace(l.image, "src=\"", "src=\"../images/")
l.image <- paste0("<div class=\"stroke\">",l.image,"</div>")
l.strokes <- l[9]
l.hei <- l[11]
l.hei <- str_replace_all(l.hei, "\"", "&quot;")
l.hei <- str_replace_all(l.hei, "<div>", "<p>")
l.hei <- str_replace_all(l.hei, "</div>", "</p>")
l.on <- l[17]
l.kun <- l[18]
l.word <- l[19]
l.word <- str_replace_all(l.word, "<br[ ]*[/]?>", "\n\n")
l.example <- l[20]
l.na <- paste0(str_dup("0",4-str_length(l.no)),l.no)
content <- paste0("---\nlayout: post\ntitle: " ,l.ka," ",l.key,
"\nkanji: ", l.ka,
"\npermalink: /", l.no,"/",
"\nredirect_from:",
"\n - /", l.ka, "/",
"\n - /", tolower(l.key), "/",
"\npre_kanji: ", l.nav[i],
"\nnex_kanji: ", l.nav[i+2],
"\nheisig: \"",l.hei,"<br>",koo.v4[no=l.no,2],"\"",
"\n---",
"\n\n## `", l.key,"`",
"\n\n## [",l.strokes,"]\n\n",l.image,
"\n\n## Reading:",
"\n\n### On-Yomi: ",l.on,
ifelse(l.kun=="",""," &mdash; Kun-Yomi: "),l.kun,
# ifelse(l.example == "","",
#			 "\n\n### Examples: "), l.example,
# ifelse(l.word == "","","\n\n## Words:\n\n"), l.word,
"\n\n## Heisig V6:",
"\n\n", l.hei,
ifelse(koo.v4[no=l.no,2]=="","",
"\n\n## Premitive V4:\n\n"), koo.v4[no=l.no,2],
"\n\n## Koohii stories:",
"\n\n", koo.v4[no=l.no,3])
l.path <- paste0("/data/repos/manhtai/rtk/jisho/",l.na,".md")
writeLines(content, l.path)
i <- 809
line <- data[i]
line <- str_split(line, "\037")
l <- line[[1]]
l.no <- l[2]
l.key <- l[4]
l.ka <- l[5]
l.image <- l[6]
l.image <- str_replace(l.image, "src=\"", "src=\"../images/")
l.image <- paste0("<div class=\"stroke\">",l.image,"</div>")
l.strokes <- l[9]
l.hei <- l[11]
l.hei <- str_replace_all(l.hei, "\"", "&quot;")
l.hei <- str_replace_all(l.hei, "<div>", "<p>")
l.hei <- str_replace_all(l.hei, "</div>", "</p>")
l.on <- l[17]
l.kun <- l[18]
l.word <- l[19]
l.word <- str_replace_all(l.word, "<br[ ]*[/]?>", "\n\n")
l.example <- l[20]
l.na <- paste0(str_dup("0",4-str_length(l.no)),l.no)
content <- paste0("---\nlayout: post\ntitle: " ,l.ka," ",l.key,
"\nkanji: ", l.ka,
"\npermalink: /", l.no,"/",
"\nredirect_from:",
"\n - /", l.ka, "/",
"\n - /", tolower(l.key), "/",
"\npre_kanji: ", l.nav[i],
"\nnex_kanji: ", l.nav[i+2],
"\nheisig: \"",l.hei,"<br>",koo.v4[no=l.no,2],"\"",
"\n---",
"\n\n## `", l.key,"`",
"\n\n## [",l.strokes,"]\n\n",l.image,
"\n\n## Reading:",
"\n\n### On-Yomi: ",l.on,
ifelse(l.kun=="",""," &mdash; Kun-Yomi: "),l.kun,
# ifelse(l.example == "","",
#			 "\n\n### Examples: "), l.example,
# ifelse(l.word == "","","\n\n## Words:\n\n"), l.word,
"\n\n## Heisig V6:",
"\n\n", l.hei,
ifelse(koo.v4[no=l.no,2]=="","",
"\n\n## Premitive V4:\n\n"), koo.v4[no=l.no,2],
"\n\n## Koohii stories:",
"\n\n", koo.v4[no=l.no,3])
l.path <- paste0("/data/repos/manhtai/rtk/jisho/",l.na,".md")
writeLines(content, l.path)
line <- data[i]
line <- str_split(line, "\037")
l <- line[[1]]
l.no <- l[2]
l.key <- l[4]
l.ka <- l[5]
l.image <- l[6]
l.image <- str_replace(l.image, "src=\"", "src=\"../images/")
l.image <- paste0("<div class=\"stroke\">",l.image,"</div>")
l.strokes <- l[9]
l.hei <- l[11]
l.hei <- str_replace_all(l.hei, "\"", "&quot;")
l.hei <- str_replace_all(l.hei, "<div>", "<p>")
l.hei <- str_replace_all(l.hei, "</div>", "</p>")
l.on <- l[17]
l.kun <- l[18]
l.word <- l[19]
l.word <- str_replace_all(l.word, "<br[ ]*[/]?>", "\n\n")
l.example <- l[20]
l.na <- paste0(str_dup("0",4-str_length(l.no)),l.no)
content <- paste0("---\nlayout: post\ntitle: " ,l.ka," ",l.key,
"\nkanji: ", l.ka,
"\npermalink: /", l.no,"/",
"\nredirect_from:",
"\n - /", l.ka, "/",
"\n - /", tolower(l.key), "/",
"\npre_kanji: ", l.nav[i],
"\nnex_kanji: ", l.nav[i+2],
"\nheisig: \"",l.hei,
ifelse(koo.v4[no=l.no,2]=="",""," "),
koo.v4[no=l.no,2],"\"",
"\n---",
"\n\n## `", l.key,"`",
"\n\n## [",l.strokes,"]\n\n",l.image,
"\n\n## Reading:",
"\n\n### On-Yomi: ",l.on,
ifelse(l.kun=="",""," &mdash; Kun-Yomi: "),l.kun,
# ifelse(l.example == "","",
#			 "\n\n### Examples: "), l.example,
# ifelse(l.word == "","","\n\n## Words:\n\n"), l.word,
"\n\n## Heisig V6:",
"\n\n", l.hei,
ifelse(koo.v4[no=l.no,2]=="","",
"\n\n## Premitive V4:\n\n"), koo.v4[no=l.no,2],
"\n\n## Koohii stories:",
"\n\n", koo.v4[no=l.no,3])
l.path <- paste0("/data/repos/manhtai/rtk/jisho/",l.na,".md")
writeLines(content, l.path)
for (i in 1:n) {
line <- data[i]
line <- str_split(line, "\037")
l <- line[[1]]
l.no <- l[2]
l.key <- l[4]
l.ka <- l[5]
l.image <- l[6]
l.image <- str_replace(l.image, "src=\"", "src=\"../images/")
l.image <- paste0("<div class=\"stroke\">",l.image,"</div>")
l.strokes <- l[9]
l.hei <- l[11]
l.hei <- str_replace_all(l.hei, "\"", "&quot;")
l.hei <- str_replace_all(l.hei, "<div>", "<p>")
l.hei <- str_replace_all(l.hei, "</div>", "</p>")
l.on <- l[17]
l.kun <- l[18]
l.word <- l[19]
l.word <- str_replace_all(l.word, "<br[ ]*[/]?>", "\n\n")
l.example <- l[20]
l.na <- paste0(str_dup("0",4-str_length(l.no)),l.no)
content <- paste0("---\nlayout: post\ntitle: " ,l.ka," ",l.key,
"\nkanji: ", l.ka,
"\npermalink: /", l.no,"/",
"\nredirect_from:",
"\n - /", l.ka, "/",
"\n - /", tolower(l.key), "/",
"\npre_kanji: ", l.nav[i],
"\nnex_kanji: ", l.nav[i+2],
"\nheisig: \"",l.hei,
ifelse(koo.v4[no=l.no,2]=="",""," "),
koo.v4[no=l.no,2],"\"",
"\n---",
"\n\n## `", l.key,"`",
"\n\n## [",l.strokes,"]\n\n",l.image,
"\n\n## Reading:",
"\n\n### On-Yomi: ",l.on,
ifelse(l.kun=="",""," &mdash; Kun-Yomi: "),l.kun,
# ifelse(l.example == "","",
#			 "\n\n### Examples: "), l.example,
# ifelse(l.word == "","","\n\n## Words:\n\n"), l.word,
"\n\n## Heisig V6:",
"\n\n", l.hei,
ifelse(koo.v4[no=l.no,2]=="","",
"\n\n## Premitive V4:\n\n"), koo.v4[no=l.no,2],
"\n\n## Koohii stories:",
"\n\n", koo.v4[no=l.no,3])
l.path <- paste0("/data/repos/manhtai/rtk/jisho/",l.na,".md")
writeLines(content, l.path)
}
i <- 2110
line <- data[i]
line <- str_split(line, "\037")
l <- line[[1]]
l.no <- l[2]
library(stringr)
data <- read.csv("database.csv")
data <- as.vector(data$flds)
koo.v4 <- readRDS("koohii.rds")
line <- data[i]
line <- str_split(line, "\037")
l <- line[[1]]
l.no <- l[2]
(as.numeric(l.no) < 2043)
n <- length(data)
l.nav <- rep(0, n+2)
for (i in 1:n) {
line <- data[i]
line <- str_split(line, "\037")
l <- line[[1]]
l.nav[i+1] <- l[2]
}
for (i in 1:n) {
line <- data[i]
line <- str_split(line, "\037")
l <- line[[1]]
l.no <- l[2]
if (as.numeric(l.no) < 2043) {
l.key <- l[4]
l.ka <- l[5]
l.image <- l[6]
l.image <- str_replace(l.image, "src=\"", "src=\"../images/")
l.image <- paste0("<div class=\"stroke\">",l.image,"</div>")
l.strokes <- l[9]
l.hei <- l[11]
l.hei <- str_replace_all(l.hei, "\"", "&quot;")
l.hei <- str_replace_all(l.hei, "<div>", "\n")
l.hei <- str_replace_all(l.hei, "</div>", "")
l.on <- l[17]
l.kun <- l[18]
l.word <- l[19]
l.word <- str_replace_all(l.word, "<br[ ]*[/]?>", "\n\n")
l.example <- l[20]
l.na <- paste0(str_dup("0",4-str_length(l.no)),l.no)
content <- paste0("---\nlayout: post\ntitle: " ,l.ka," ",l.key,
"\nkanji: ", l.ka,
"\npermalink: /", l.no,"/",
"\nredirect_from:",
"\n - /", l.ka, "/",
"\n - /", tolower(l.key), "/",
"\npre_kanji: ", l.nav[i],
"\nnex_kanji: ", l.nav[i+2],
"\nheisig: \"",l.hei,
ifelse(koo.v4[no=l.no,2]=="",""," "),
koo.v4[no=l.no,2],"\"",
"\n---",
"\n\n## `", l.key,"`",
"\n\n## [",l.strokes,"]\n\n",l.image,
"\n\n## Reading:",
"\n\n### On-Yomi: ",l.on,
ifelse(l.kun=="",""," &mdash; Kun-Yomi: "),l.kun,
"\n\n## Heisig story:",
"\n\n", l.hei,
ifelse(koo.v4[no=l.no,2]=="","",
"\n\n## Premitive:\n\n"), koo.v4[no=l.no,2],
"\n\n## Koohii stories:",
"\n\n", koo.v4[no=l.no,3])
l.path <- paste0("/data/repos/manhtai/rtk/jisho/",l.na,".md")
writeLines(content, l.path)
}
}
for (i in 1:n) {
line <- data[i]
line <- str_split(line, "\037")
l <- line[[1]]
l.no <- l[2]
if (as.numeric(l.no) < 2043) {
l.key <- l[4]
l.ka <- l[5]
l.image <- l[6]
l.image <- str_replace(l.image, "src=\"", "src=\"../images/")
l.image <- paste0("<div class=\"stroke\">",l.image,"</div>")
l.strokes <- l[9]
l.hei <- l[11]
l.hei <- str_replace_all(l.hei, "\"", "&quot;")
l.hei <- str_replace_all(l.hei, "<div>", "\n")
l.hei <- str_replace_all(l.hei, "</div>", "")
l.on <- l[17]
l.kun <- l[18]
l.word <- l[19]
l.word <- str_replace_all(l.word, "<br[ ]*[/]?>", "\n\n")
l.example <- l[20]
l.na <- paste0(str_dup("0",4-str_length(l.no)),l.no)
content <- paste0("---\nlayout: post\ntitle: " ,l.ka," ",l.key,
"\nkanji: ", l.ka,
"\npermalink: /", l.no,"/",
"\nredirect_from:",
"\n - /", l.ka, "/",
"\n - /", tolower(l.key), "/",
"\npre_kanji: ", l.nav[i],
"\nnex_kanji: ", l.nav[i+2],
ifelse(l.hei=="","","\nheisig: \""),l.hei,
ifelse(koo.v4[no=l.no,2]=="",""," "),
koo.v4[no=l.no,2],"\"",
"\n---",
"\n\n## `", l.key,"`",
"\n\n## [",l.strokes,"]\n\n",l.image,
"\n\n## Reading:",
"\n\n### On-Yomi: ",l.on,
ifelse(l.kun=="",""," &mdash; Kun-Yomi: "),l.kun,
ifelse(l.hei=="","","\n\n## Heisig story:\n\n"),
l.hei,
ifelse(koo.v4[no=l.no,2]=="","",
"\n\n## Premitive:\n\n"), koo.v4[no=l.no,2],
"\n\n## Koohii stories:",
"\n\n", koo.v4[no=l.no,3])
l.path <- paste0("/data/repos/manhtai/rtk/jisho/",l.na,".md")
writeLines(content, l.path)
}
}
l.hei!=""
ok <-     if (l.hei!="") {
"\nheisig: \"",l.hei,
ifelse(koo.v4[no=l.no,2]=="",""," "),
koo.v4[no=l.no,2],
"\"",
}
ok <- if (l.hei!="") {
"\nheisig: \"",l.hei,
ifelse(koo.v4[no=l.no,2]=="",""," "),
koo.v4[no=l.no,2],
"\"",
}
for (i in 1:n) {
line <- data[i]
line <- str_split(line, "\037")
l <- line[[1]]
l.no <- l[2]
if (as.numeric(l.no) < 2043) {
l.key <- l[4]
l.ka <- l[5]
l.image <- l[6]
l.image <- str_replace(l.image, "src=\"", "src=\"../images/")
l.image <- paste0("<div class=\"stroke\">",l.image,"</div>")
l.strokes <- l[9]
l.hei <- l[11]
l.hei <- str_replace_all(l.hei, "\"", "&quot;")
l.hei <- str_replace_all(l.hei, "<div>", "\n")
l.hei <- str_replace_all(l.hei, "</div>", "")
l.on <- l[17]
l.kun <- l[18]
l.word <- l[19]
l.word <- str_replace_all(l.word, "<br[ ]*[/]?>", "\n\n")
l.example <- l[20]
l.na <- paste0(str_dup("0",4-str_length(l.no)),l.no)
l.pre <- koo.v4[no=l.no,2]
l.koo <- koo.v4[no=l.no,3]
content <- paste0("---\nlayout: post\ntitle: " ,l.ka," ",l.key,
"\nkanji: ", l.ka,
"\npermalink: /", l.no,"/",
"\nredirect_from:",
"\n - /", l.ka, "/",
"\n - /", tolower(l.key), "/",
"\npre_kanji: ", l.nav[i],
"\nnex_kanji: ", l.nav[i+2],
ifelse(l.hei=="","","\nheisig: \""),l.hei,
ifelse(l.pre=="",""," "),
l.pre,
ifelse(l.hei=="","","\""),
"\n---",
"\n\n## `", l.key,"`",
"\n\n## [",l.strokes,"]\n\n",l.image,
"\n\n## Reading:",
"\n\n### On-Yomi: ",l.on,
ifelse(l.kun=="",""," &mdash; Kun-Yomi: "),l.kun,
ifelse(l.hei=="","","\n\n## Heisig story:\n\n"),
l.hei,
ifelse(l.pre=="","",
"\n\n## Premitive:\n\n"), l.pre,
"\n\n## Koohii stories:",
"\n\n", l.koo)
l.path <- paste0("/data/repos/manhtai/rtk/jisho/",l.na,".md")
writeLines(content, l.path)
}
}
library(stringr)
koohii <- readLines("/data/Downloads/rtk20.txt")
koo.v4 <- matrix(rep("",3*3030), ncol = 3,
dimnames = list(1:3030,c("no","s0","s2")))
for (i in 1:3030) {
# Reset k.s0
k.s0 <- ""
# Input
kine <- koohii[i]
kine <- str_split(kine, "\t")
k <- kine[[1]]
# Set V4 number to k.no
k.no <- k[5]
# Check and set premitive to k.s0
k.s1 <- k[3]
k.pc <- str_locate(k.s1, "[*]")
if (!is.na(k.pc[1])) {
k.lc <- str_locate(k.s1, "[[][[:digit:]]+[]]")
if (k.pc[1] == 1) {
k.s0 <- str_sub(k.s1, 3, k.lc[2])
k.s0 <- str_trim(k.s0)
}
}
# Set Koohii stories to k.s2 and clear up
k.s2 <- k[8]
k.s2 <- str_split(k.s2, "<br[ ]*[/]?>")[[1]][2:11]
k.s2 <- str_replace_all(k.s2, "\"{2,}", "\"")
k.s2 <- str_replace_all(k.s2, "<a href=\"midori://search[?]text=([[:print:]]+)\">[[:print:]]+</a>", "\\1")
k.s2 <- str_replace_all(k.s2, "http://kanji.koohii.com/study/kanji/", "../")
k.s2 <- str_replace_all(k.s2, "<span class=\"index\">", "")
k.s2 <- str_replace_all(k.s2, "</span>", "")
k.s2 <- str_replace_all(k.s2, "[[:space:]]{2,}", " ")
k.s2 <- str_trim(k.s2)
k.s2 <- str_c(k.s2, collapse = "\n\n")
# Save to matrix
koo.v4[i,1] <- k.no
koo.v4[i,2] <- k.s0
koo.v4[i,3] <- k.s2
}
koo.v4[no=1949,3]
i <- 1949
# Reset k.s0
k.s0 <- ""
# Input
kine <- koohii[i]
kine <- str_split(kine, "\t")
k <- kine[[1]]
# Set V4 number to k.no
k.no <- k[5]
# Check and set premitive to k.s0
k.s1 <- k[3]
k.pc <- str_locate(k.s1, "[*]")
if (!is.na(k.pc[1])) {
k.lc <- str_locate(k.s1, "[[][[:digit:]]+[]]")
if (k.pc[1] == 1) {
k.s0 <- str_sub(k.s1, 3, k.lc[2])
k.s0 <- str_trim(k.s0)
}
}
# Set Koohii stories to k.s2 and clear up
k.s2 <- k[8]
k.s2 <- str_split(k.s2, "<br[ ]*[/]?>")[[1]][2:11]
k.s2 <- str_replace_all(k.s2, "\"{2,}", "\"")
k.s2 <- str_replace_all(k.s2, "<a href=\"midori://search[?]text=([[:alnum:]]+)\">[[:alnum:]]+</a>", "\\1")
k.s2 <- str_replace_all(k.s2, "http://kanji.koohii.com/study/kanji/", "../")
k.s2 <- str_replace_all(k.s2, "<span class=\"index\">", "")
k.s2 <- str_replace_all(k.s2, "</span>", "")
k.s2 <- str_replace_all(k.s2, "[[:space:]]{2,}", " ")
k.s2 <- str_trim(k.s2)
k.s2 <- str_c(k.s2, collapse = "\n\n")
# Save to matrix
koo.v4[i,1] <- k.no
koo.v4[i,2] <- k.s0
koo.v4[i,3] <- k.s2
k.s2
k.s2 <- str_replace_all(k.s2, "midori://search[?]text=", "http://google.com/#q=")
k.s2
